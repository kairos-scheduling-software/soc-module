!function(t,e){"use strict";if("object"==typeof exports)module.exports=e(require("d3"));else if("function"==typeof define&&define.amd)define(["d3"],function(i){return t.dimple=e(i),t.dimple});else if(t.d3)t.dimple=e(t.d3);else{if(!console||!console.warn)throw"dimple requires d3 to run.  Are you missing a reference to the d3 library?";console.warn("dimple requires d3 to run.  Are you missing a reference to the d3 library?")}}(this,function(t){"use strict";var e={version:"2.1.3",plot:{},aggregateMethod:{}};return e.axis=function(i,s,a,r,n){this.chart=i,this.position=s,this.categoryFields=null===n||void 0===n?a:[].concat(n),this.measure=r,this.timeField=n,this.floatingBarWidth=5,this.hidden=!1,this.showPercent=!1,this.colors=null,this.overrideMin=null,this.overrideMax=null,this.shapes=null,this.showGridlines=null,this.gridlineShapes=null,this.titleShape=null,this.dateParseFormat=null,this.tickFormat=null,this.timePeriod=null,this.timeInterval=1,this.useLog=!1,this.logBase=10,this.title=void 0,this.clamp=!0,this.ticks=null,this.fontSize="10px",this.fontFamily="sans-serif",this._slaves=[],this._scale=null,this._min=0,this._max=0,this._previousOrigin=null,this._origin=null,this._orderRules=[],this._groupOrderRules=[],this._draw=null,this._getAxisData=function(){var t,e,i=[],s=!1;if(this.chart&&this.chart.series){for(t=0;t<this.chart.series.length;t+=1)e=this.chart.series[t],e[this.position]===this&&(e.data&&e.data.length>0?i=i.concat(e.data):s=!0);s&&this.chart.data&&(i=i.concat(this.chart.data))}return i},this._getFontSize=function(){var t;return t=this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._getFormat=function(){var e,i,s,a,r,n,o;return null!==this.tickFormat&&void 0!==this.tickFormat?e=this._hasTimeField()?t.time.format(this.tickFormat):t.format(this.tickFormat):this.showPercent?e=t.format("%"):this.useLog&&null!==this.measure?e=function(e){var i=Math.floor(Math.abs(e),0).toString().length,s=Math.min(Math.floor((i-1)/3),4),a="kmBT".substring(s-1,s),r="0"===Math.round(e/Math.pow(1e3,s)*10).toString().slice(-1)?0:1;return 0===e?0:t.format(",."+r+"f")(e/Math.pow(1e3,s))+a}:null!==this.measure?(i=Math.floor(Math.abs(this._max),0).toString(),s=Math.floor(Math.abs(this._min),0).toString(),a=Math.max(s.length,i.length),a>3?(r=Math.min(Math.floor((a-1)/3),4),n="kmBT".substring(r-1,r),o=1>=a-3*r?1:0,e=function(e){return 0===e?0:t.format(",."+o+"f")(e/Math.pow(1e3,r))+n}):(o=-Math.floor(Math.log(this._tick_step)/Math.LN10),e=t.format(",."+o+"f"))):e=function(t){return t},e},this._getTimePeriod=function(){var e=this.timePeriod,i=30,s=this._max-this._min;return this._hasTimeField()&&!this.timePeriod&&(e=i>=s/1e3?t.time.seconds:i>=s/6e4?t.time.minutes:i>=s/36e5?t.time.hours:i>=s/864e5?t.time.days:i>=s/6048e5?t.time.weeks:i>=s/26298e5?t.time.months:t.time.years),e},this._getTooltipText=function(e,i){if(this._hasTimeField())i[this.position+"Field"][0]&&e.push(this.timeField+": "+this._getFormat()(i[this.position+"Field"][0]));else if(this._hasCategories())this.categoryFields.forEach(function(t,s){null!==t&&void 0!==t&&i[this.position+"Field"][s]&&e.push(t+(i[this.position+"Field"][s]!==t?": "+i[this.position+"Field"][s]:""))},this);else if(this._hasMeasure())switch(this.position){case"x":e.push(this.measure+": "+this._getFormat()(i.width));break;case"y":e.push(this.measure+": "+this._getFormat()(i.height));break;case"p":e.push(this.measure+": "+this._getFormat()(i.angle)+" ("+t.format("%")(i.piePct)+")");break;default:e.push(this.measure+": "+this._getFormat()(i[this.position+"Value"]))}},this._getTopMaster=function(){var t=this;return null!==this.master&&void 0!==this.master&&(t=this.master._getTopMaster()),t},this._hasCategories=function(){return null!==this.categoryFields&&void 0!==this.categoryFields&&this.categoryFields.length>0},this._hasMeasure=function(){return null!==this.measure&&void 0!==this.measure},this._hasTimeField=function(){return null!==this.timeField&&void 0!==this.timeField},this._parseDate=function(e){var i;return i=null===this.dateParseFormat||void 0===this.dateParseFormat?isNaN(e)?Date.parse(e):new Date(e):t.time.format(this.dateParseFormat).parse(e)},this._update=function(i){var s,a,r,n,o=[],l=this.ticks||10,h=function(t,i,s){var a,r,n=t.categoryFields[0],o=t._getAxisData(),l=n,h=!1,u=!0,c=null;for(a=0;a<o.length;a+=1)if(c=t._parseDate(o[a][n]),null!==c&&void 0!==c&&isNaN(c)){u=!1;break}return u||t.chart.series.forEach(function(e){e[i]===t&&e[s]._hasMeasure()&&(l=e[s].measure,h=!0)},this),r=t._orderRules.concat({ordering:l,desc:h}),e._getOrderedList(o,n,r)};if(this._min=this.showPercent&&this._min<-1?-1:this._min,this._max=this.showPercent&&this._max>1?1:this._max,this._min=null!==this.overrideMin?this.overrideMin:this._min,this._max=null!==this.overrideMax?this.overrideMax:this._max,"x"!==this.position||null!==this._scale&&!i){if("y"!==this.position||null!==this._scale&&!i)this.position.length>0&&"z"===this.position[0]&&null===this._scale?this._scale=this.useLog?t.scale.log().range([this.chart._heightPixels()/300,this.chart._heightPixels()/10]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase):t.scale.linear().range([1,this.chart._heightPixels()/10]).domain([this._min,this._max]).clamp(this.clamp):this.position.length>0&&"p"===this.position[0]&&null===this._scale?this._scale=this.useLog?t.scale.log().range([0,360]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase):t.scale.linear().range([0,360]).domain([this._min,this._max]).clamp(this.clamp):this.position.length>0&&"c"===this.position[0]&&null===this._scale&&(this._scale=t.scale.linear().range([0,null===this.colors||1===this.colors.length?1:this.colors.length-1]).domain([this._min,this._max]).clamp(this.clamp));else if(this._hasTimeField()?this._scale=t.time.scale().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]).clamp(this.clamp):this.useLog?this._scale=t.scale.log().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase).nice():null===this.measure||void 0===this.measure?(o=h(this,"y","x"),null!==this._slaves&&void 0!==this._slaves&&this._slaves.forEach(function(t){o=o.concat(h(t,"y","x"))},this),this._scale=t.scale.ordinal().rangePoints([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain(o.concat([""]))):this._scale=t.scale.linear().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]).clamp(this.clamp).nice(),!this.hidden)switch(this.chart._axisIndex(this,"y")){case 0:this._draw=t.svg.axis().orient("left").scale(this._scale),this.ticks&&this._draw.ticks(l);break;case 1:this._draw=t.svg.axis().orient("right").scale(this._scale),this.ticks&&this._draw.ticks(l)}}else if(this._hasTimeField()?this._scale=t.time.scale().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]).clamp(this.clamp):this.useLog?this._scale=t.scale.log().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase).nice():null===this.measure||void 0===this.measure?(o=h(this,"x","y"),null!==this._slaves&&void 0!==this._slaves&&this._slaves.forEach(function(t){o=o.concat(h(t,"x","y"))},this),this._scale=t.scale.ordinal().rangePoints([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain(o.concat([""]))):this._scale=t.scale.linear().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]).clamp(this.clamp).nice(),!this.hidden)switch(this.chart._axisIndex(this,"x")){case 0:this._draw=t.svg.axis().orient("bottom").scale(this._scale),this.ticks&&this._draw.ticks(l);break;case 1:this._draw=t.svg.axis().orient("top").scale(this._scale),this.ticks&&this._draw.ticks(l)}return null!==this._slaves&&void 0!==this._slaves&&this._slaves.length>0&&this._slaves.forEach(function(t){t._scale=this._scale},this),null!==i&&void 0!==i&&i!==!1||this._hasTimeField()||null===this._scale||null===this._scale.ticks||void 0===this._scale.ticks||!(this._scale.ticks(l).length>0)||"x"!==this.position&&"y"!==this.position||(s=this._scale.ticks(l),a=s[1]-s[0],r=((this._max-this._min)%a).toFixed(0),this._tick_step=a,0!==r&&(this._max=Math.ceil(this._max/a)*a,this._min=Math.floor(this._min/a)*a,this._update(!0))),n=this._scale.copy()(null!==o&&void 0!==o&&o.length>0?o[0]:this._min>0?this._min:this._max<0?this._max:0),this._origin!==n&&(this._previousOrigin=null===this._origin?n:this._origin,this._origin=n),this},this.addGroupOrderRule=function(t,e){this._groupOrderRules.push({ordering:t,desc:e})},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})}},e.chart=function(i,s){this.svg=i,this.x="10%",this.y="10%",this.width="80%",this.height="80%",this.data=s,this.noFormats=!1,this.axes=[],this.series=[],this.legends=[],this.storyboard=null,this.titleShape=null,this.shapes=null,this.ease="cubic-in-out",this.staggerDraw=!1,this._group=i.append("g"),this._tooltipGroup=null,this._assignedColors={},this._assignedClasses={},this._nextColor=0,this._nextClass=0,this._axisIndex=function(t,e){var i=0,s=0,a=-1;for(i=0;i<this.axes.length;i+=1){if(this.axes[i]===t){a=s;break}(null===e||void 0===e||e[0]===this.axes[i].position[0])&&(s+=1)}return a},this._getAllData=function(){var t=[];return null!==this.data&&void 0!==this.data&&this.data.length>0&&(t=t.concat(this.data)),null!==this.series&&void 0!==this.series&&this.series.length>0&&this.series.forEach(function(e){null!==e.data&&void 0!==e.data&&e.data.length>0&&(t=t.concat(e.data))}),t},this._getData=function(i,s,a,r,n,o,l,h,u,c){var d,g,p=[],_=function(t,e){var i=[];return null!==t&&(t._hasTimeField()?i.push(t._parseDate(e[t.timeField])):t._hasCategories()&&t.categoryFields.forEach(function(t){i.push(e[t])},this)),i},f={x:!1,y:!1,z:!1,p:!1,c:!1},x={x:[],y:[]},y={x:[],y:[],z:[],p:[]},m={min:null,max:null},v={x:[],y:[],z:[],p:[]},F=[],k={},w={x:0,y:0,z:0,p:0},C="",b=[],P=[],B=[],S="",M=[],T="",z=[],O="",V=[],L=[],A=i,G=[];this.storyboard&&this.storyboard.categoryFields.length>0&&(C=this.storyboard.categoryFields[0],b=e._getOrderedList(A,C,this.storyboard._orderRules)),o&&o._hasCategories()&&o._hasMeasure()&&(S=o.categoryFields[0],M=e._getOrderedList(A,S,o._orderRules.concat([{ordering:o.measure,desc:!0}]))),l&&l._hasCategories()&&l._hasMeasure()&&(T=l.categoryFields[0],z=e._getOrderedList(A,T,l._orderRules.concat([{ordering:l.measure,desc:!0}]))),u&&u._hasCategories()&&u._hasMeasure()&&(O=u.categoryFields[0],V=e._getOrderedList(A,O,u._orderRules.concat([{ordering:u.measure,desc:!0}]))),A.length>0&&s&&s.length>0&&(L=[].concat(r),P=[],s.forEach(function(t){void 0!==A[0][t]&&P.push(t)},this),u&&u._hasMeasure()?L.push({ordering:u.measure,desc:!0}):c&&c._hasMeasure()?L.push({ordering:c.measure,desc:!0}):h&&h._hasMeasure()?L.push({ordering:h.measure,desc:!0}):o&&o._hasMeasure()?L.push({ordering:o.measure,desc:!0}):l&&l._hasMeasure()&&L.push({ordering:l.measure,desc:!0}),B=e._getOrderedList(A,P,L)),A.sort(function(t,e){var i,s,a,r,n,o,l=0;if(""!==C&&(l=b.indexOf(t[C])-b.indexOf(e[C])),""!==S&&0===l&&(l=M.indexOf(t[S])-M.indexOf(e[S])),""!==T&&0===l&&(l=z.indexOf(t[T])-z.indexOf(e[T])),""!==O&&0===l&&(l=V.indexOf(t[O])-z.indexOf(e[O])),P&&P.length>0&&0===l)for(i=[].concat(P),l=0,a=0;a<B.length;a+=1){for(s=[].concat(B[a]),n=!0,o=!0,r=0;r<i.length;r+=1)n=n&&t[i[r]]===s[r],o=o&&e[i[r]]===s[r];if(n&&o){l=0;break}if(n){l=-1;break}if(o){l=1;break}}return l}),A.forEach(function(t){var e,i,r,n,d,g=-1,x=_(o,t),y=_(l,t),m=_(h,t),v=_(u,t),F=[];if(s&&0!==s.length)for(r=0;r<s.length;r+=1)F.push(void 0===t[s[r]]?s[r]:t[s[r]]);else F=["All"];for(e=F.join("/")+"_"+x.join("/")+"_"+y.join("/")+"_"+v.join("/")+"_"+m.join("/"),i=0;i<p.length;i+=1)if(p[i].key===e){g=i;break}-1===g&&(n={key:e,aggField:F,xField:x,xValue:null,xCount:0,yField:y,yValue:null,yCount:0,pField:v,pValue:null,pCount:0,zField:m,zValue:null,zCount:0,cValue:0,cCount:0,x:0,y:0,xOffset:0,yOffset:0,width:0,height:0,cx:0,cy:0,xBound:0,yBound:0,xValueList:[],yValueList:[],zValueList:[],pValueList:[],cValueList:[],fill:{},stroke:{}},p.push(n),g=p.length-1),d=function(e,i){var s,r,n=!0,o={value:0,count:1},l={value:0,count:1},h="";null!==i&&(s=i.getFrameValue(),i.categoryFields.forEach(function(e,i){i>0&&(h+="/"),h+=t[e],n=h===s},this)),null!==e&&void 0!==e&&n&&(r=p[g],e._hasMeasure()&&null!==t[e.measure]&&void 0!==t[e.measure]&&(-1===r[e.position+"ValueList"].indexOf(t[e.measure])&&r[e.position+"ValueList"].push(t[e.measure]),isNaN(parseFloat(t[e.measure]))&&(f[e.position]=!0),o.value=r[e.position+"Value"],o.count=r[e.position+"Count"],l.value=t[e.measure],r[e.position+"Value"]=a(o,l),r[e.position+"Count"]+=1))},d(o,this.storyboard),d(l,this.storyboard),d(h,this.storyboard),d(u,this.storyboard),d(c,this.storyboard)},this),o&&o._hasCategories()&&o.categoryFields.length>1&&void 0!==x.x&&(G=[],l._hasMeasure()&&G.push({ordering:l.measure,desc:!0}),x.x=e._getOrderedList(A,o.categoryFields[1],o._groupOrderRules.concat(G))),l&&l._hasCategories()&&l.categoryFields.length>1&&void 0!==x.y&&(G=[],o._hasMeasure()&&G.push({ordering:o.measure,desc:!0}),x.y=e._getOrderedList(A,l.categoryFields[1],l._groupOrderRules.concat(G)),x.y.reverse()),p.forEach(function(t){null!==o&&(f.x===!0&&(t.xValue=t.xValueList.length),d=(y.x[t.xField.join("/")]||0)+(l._hasMeasure()?Math.abs(t.yValue):0),y.x[t.xField.join("/")]=d),null!==l&&(f.y===!0&&(t.yValue=t.yValueList.length),d=(y.y[t.yField.join("/")]||0)+(o._hasMeasure()?Math.abs(t.xValue):0),y.y[t.yField.join("/")]=d),null!==u&&(f.p===!0&&(t.pValue=t.pValueList.length),d=(y.p[t.pField.join("/")]||0)+(u._hasMeasure()?Math.abs(t.pValue):0),y.p[t.pField.join("/")]=d),null!==h&&(f.z===!0&&(t.zValue=t.zValueList.length),d=(y.z[t.zField.join("/")]||0)+(h._hasMeasure()?Math.abs(t.zValue):0),y.z[t.zField.join("/")]=d),null!==c&&((null===m.min||t.cValue<m.min)&&(m.min=t.cValue),(null===m.max||t.cValue>m.max)&&(m.max=t.cValue))},this);for(g in y.x)y.x.hasOwnProperty(g)&&(w.x+=y.x[g]);for(g in y.y)y.y.hasOwnProperty(g)&&(w.y+=y.y[g]);for(g in y.p)y.p.hasOwnProperty(g)&&(w.p+=y.p[g]);for(g in y.z)y.z.hasOwnProperty(g)&&(w.z+=y.z[g]);return p.forEach(function(e){var i,s,a,r,d,g=function(t,i,s){var a,r,o,l,h;null!==t&&void 0!==t&&(l=t.position,t._hasCategories()?t._hasMeasure()?(a=e[t.position+"Field"].join("/"),r=t.showPercent?y[t.position][a]/w[t.position]:y[t.position][a],-1===F.indexOf(a)&&(k[a]=r+(F.length>0?k[F[F.length-1]]:0),F.push(a)),o=e[l+"Bound"]=e["c"+l]="x"!==l&&"y"!==l||!n?r:k[a],e[s]=r,e[l]=o-("x"===l&&r>=0||"y"===l&&0>=r?r:0)):(e[l]=e["c"+l]=e[l+"Field"][0],e[s]=1,void 0!==x[l]&&null!==x[l]&&x[l].length>=2&&(e[l+"Offset"]=x[l].indexOf(e[l+"Field"][1]),e[s]=1/x[l].length)):(r=t.showPercent?e[l+"Value"]/y[i][e[i+"Field"].join("/")]:e[l+"Value"],a=e[i+"Field"].join("/")+(e[l+"Value"]>=0),h=v[l][a]=(null===v[l][a]||void 0===v[l][a]||"z"===l||"p"===l?0:v[l][a])+r,o=e[l+"Bound"]=e["c"+l]="x"!==l&&"y"!==l||!n?r:h,e[s]=r,e[l]=o-("x"===l&&r>=0||"y"===l&&0>=r?r:0)))};g(o,"y","width"),g(l,"x","height"),g(h,"z","r"),g(u,"p","angle"),null!==c&&null!==m.min&&null!==m.max&&(m.min===m.max&&(m.min-=.5,m.max+=.5),m.min=c.overrideMin||m.min,m.max=c.overrideMax||m.max,e.cValue=e.cValue>m.max?m.max:e.cValue<m.min?m.min:e.cValue,a=t.scale.linear().range([0,null===c.colors||1===c.colors.length?1:c.colors.length-1]).domain([m.min,m.max]),r=a(e.cValue),d=r-Math.floor(r),e.cValue===m.max&&(d=1),c.colors&&1===c.colors.length?(i=t.rgb(c.colors[0]),s=t.rgb(this.getColor(e.aggField.slice(-1)[0]).fill)):c.colors&&c.colors.length>1?(i=t.rgb(c.colors[Math.floor(r)]),s=t.rgb(c.colors[Math.ceil(r)])):(i=t.rgb("white"),s=t.rgb(this.getColor(e.aggField.slice(-1)[0]).fill)),i.r=Math.floor(i.r+(s.r-i.r)*d),i.g=Math.floor(i.g+(s.g-i.g)*d),i.b=Math.floor(i.b+(s.b-i.b)*d),e.fill=i.toString(),e.stroke=i.darker(.5).toString())},this),p},this._getDelay=function(t,i,s){return function(a){var r=0;return s&&i.staggerDraw&&(s.x._hasCategories()?r=e._helpers.cx(a,i,s)/i._widthPixels()*t:s.y._hasCategories()&&(r=(1-e._helpers.cy(a,i,s)/i._heightPixels())*t)),r}},this._getSeriesData=function(){null!==this.series&&void 0!==this.series&&this.series.forEach(function(t){var e,i,s,a,r,n,o=t.data||this.data||[],l=[].concat(t.categoryFields||"All"),h=this._getData(o,l,t.aggregate,t._orderRules,t._isStacked(),t.x,t.y,t.z,t.p,t.c),u=[],c={},d=t.startAngle*(Math.PI/180)||0,g=(t.endAngle||360)*(Math.PI/180);if(d>g&&(d-=2*Math.PI),t.p&&l.length>0){if(t.x&&t.y){for(l.pop(),u=this._getData(o,["__dimple_placeholder__"].concat(l),t.aggregate,t._orderRules,t._isStacked(),t.x,t.y,t.z,t.p,t.c),e=0;e<h.length;e+=1)for(s=["__dimple_placeholder__"].concat(h[e].aggField),s.pop(),t.x&&t.x._hasCategories()&&(s=s.concat(h[e].xField)),t.y&&t.y._hasCategories()&&(s=s.concat(h[e].yField)),a=s.join("|"),i=0;i<u.length;i+=1)if(r=[].concat(u[i].aggField),t.x&&t.x._hasCategories()&&(r=r.concat(u[i].xField)),t.y&&t.y._hasCategories()&&(r=r.concat(u[i].yField)),n=r.join("|"),a===n){h[e].xField=u[i].xField,h[e].xValue=u[i].xValue,h[e].xCount=u[i].xCount,h[e].yField=u[i].yField,h[e].yValue=u[i].yValue,h[e].yCount=u[i].yCount,h[e].zField=u[i].zField,h[e].zValue=u[i].zValue,h[e].zCount=u[i].zCount,h[e].x=u[i].x,h[e].y=u[i].y,h[e].r=u[i].r,h[e].xOffset=u[i].xOffset,h[e].yOffset=u[i].yOffset,h[e].width=u[i].width,h[e].height=u[i].height,h[e].cx=u[i].cx,h[e].cy=u[i].cy,h[e].xBound=u[i].xBound,h[e].yBound=u[i].yBound,h[e].xValueList=u[i].xValueList,h[e].yValueList=u[i].yValueList,h[e].zValueList=u[i].zValueList,h[e].cValueList=u[i].cValueList,h[e].pieKey=u[i].key,h[e].value=h.pValue,c[u[i].key]||(c[u[i].key]={total:0,angle:d}),c[u[i].key].total+=h[e].pValue;break}}else for(e=0;e<h.length;e+=1)h[e].pieKey="All",h[e].value=h.pValue,c[h[e].pieKey]||(c[h[e].pieKey]={total:0,angle:d}),c[h[e].pieKey].total+=h[e].pValue;for(e=0;e<h.length;e+=1)h[e].piePct=h[e].pValue/c[h[e].pieKey].total,h[e].startAngle=c[h[e].pieKey].angle,h[e].endAngle=h[e].startAngle+h[e].piePct*(g-d),c[h[e].pieKey].angle=h[e].endAngle}t._positionData=h},this)},this._handleTransition=function(t,e,i,s){var a=null;return a=0===e?t:t.transition().duration(e).delay(i._getDelay(e,i,s)).ease(i.ease)},this._heightPixels=function(){return e._parseYPosition(this.height,this.svg.node())},this._registerEventHandlers=function(i){null!==i._eventHandlers&&i._eventHandlers.length>0&&i._eventHandlers.forEach(function(s){var a,r=function(a){var r=new e.eventArgs;null!==i.chart.storyboard&&(r.frameValue=i.chart.storyboard.getFrameValue()),r.seriesValue=a.aggField,r.xValue=a.x,r.yValue=a.y,r.zValue=a.z,r.pValue=a.p,r.colorValue=a.cValue,r.seriesShapes=i.shapes,r.selectedShape=t.select(this),s.handler(r)};if(null!==s.handler&&"function"==typeof s.handler)if(null!==i._markers&&void 0!==i._markers)for(a in i._markers)i._markers.hasOwnProperty(a)&&i._markers[a].on(s.event,r);else i.shapes.on(s.event,r)},this)},this._widthPixels=function(){return e._parseXPosition(this.width,this.svg.node())},this._xPixels=function(){return e._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return e._parseYPosition(this.y,this.svg.node())},this.addAxis=function(t,i,s,a){var r=null,n=null;if(null!==i&&void 0!==i&&(i=[].concat(i)),"string"==typeof t||t instanceof String)r=new e.axis(this,t,i,s,a),this.axes.push(r);else{if(n=t,r=new e.axis(this,n.position,i,s,a),r._hasMeasure()!==n._hasMeasure())throw"You have specified a composite axis where some but not all axes have a measure - this is not supported, all axes must be of the same type.";if(r._hasTimeField()!==n._hasTimeField())throw"You have specified a composite axis where some but not all axes have a time field - this is not supported, all axes must be of the same type.";if((null===r.categoryFields||void 0===r.categoryFields?0:r.categoryFields.length)!==(null===n.categoryFields||void 0===n.categoryFields?0:n.categoryFields.length))throw"You have specified a composite axis where axes have differing numbers of category fields - this is not supported, all axes must be of the same type.";n._slaves.push(r)}return r},this.addCategoryAxis=function(t,e){return this.addAxis(t,e,null)},this.addColorAxis=function(t,e){var i=this.addAxis("c",null,t);return i.colors=null===e||void 0===e?null:[].concat(e),i},this.addLegend=function(t,i,s,a,r,n){n=null===n||void 0===n?this.series:[].concat(n),r=null===r||void 0===r?"left":r;var o=new e.legend(this,t,i,s,a,r,n);return this.legends.push(o),o},this.addLogAxis=function(t,e,i){var s=this.addAxis(t,null,e,null);return null!==i&&void 0!==i&&(s.logBase=i),s.useLog=!0,s},this.addMeasureAxis=function(t,e){return this.addAxis(t,null,e)},this.addPctAxis=function(t,e,i){var s=null;return s=null!==i&&void 0!==i?this.addAxis(t,i,e):this.addMeasureAxis(t,e),s.showPercent=!0,s},this.addSeries=function(t,i,s){(null===s||void 0===s)&&(s=this.axes),(null===i||void 0===i)&&(i=e.plot.bubble);var a,r=null,n=null,o=null,l=null,h=null;return s.forEach(function(t){null!==t&&i.supportedAxes.indexOf(t.position)>-1&&(null===r&&"x"===t.position[0]?r=t:null===n&&"y"===t.position[0]?n=t:null===o&&"z"===t.position[0]?o=t:null===l&&"c"===t.position[0]?l=t:null===l&&"p"===t.position[0]&&(h=t))},this),t&&(t=[].concat(t)),a=new e.series(this,t,r,n,o,l,h,i,e.aggregateMethod.sum,i.stacked),this.series.push(a),a},this.addTimeAxis=function(t,e,i,s){var a=this.addAxis(t,null,null,e);return a.tickFormat=s,a.dateParseFormat=i,a},this.assignClass=function(t,e){return this._assignedClasses[t]=e,this._assignedClasses[t]},this.assignColor=function(t,i,s,a){return this._assignedColors[t]=new e.color(i,s,a),this._assignedColors[t]},this.customClassList={axisLine:"dimple-custom-axis-line",axisLabel:"dimple-custom-axis-label",axisTitle:"dimple-custom-axis-title",tooltipBox:"dimple-custom-tooltip-box",tooltipLabel:"dimple-custom-tooltip-label",lineMarker:"dimple-custom-line-marker",legendLabel:"dimple-custom-legend-label",legendKey:"dimple-custom-legend-key",areaSeries:"dimple-custom-series-area",barSeries:"dimple-custom-series-bar",bubbleSeries:"dimple-custom-series-bubble",lineSeries:"dimple-custom-series-line",pieSeries:"dimple-custom-series-pie",gridline:"dimple-custom-gridline",colorClasses:["dimple-custom-format-1","dimple-custom-format-2","dimple-custom-format-3","dimple-custom-format-4","dimple-custom-format-5","dimple-custom-format-6","dimple-custom-format-7","dimple-custom-format-8","dimple-custom-format-9","dimple-custom-format-10"]},this.defaultColors=[new e.color("#80B1D3"),new e.color("#FB8072"),new e.color("#FDB462"),new e.color("#B3DE69"),new e.color("#FFED6F"),new e.color("#BC80BD"),new e.color("#8DD3C7"),new e.color("#CCEBC5"),new e.color("#FFFFB3"),new e.color("#BEBADA"),new e.color("#FCCDE5"),new e.color("#D9D9D9")],this.draw=function(e,i){e=e||0;var s,a,r=null,n=null,o=!1,l=!1,h=this._xPixels(),u=this._yPixels(),c=this._widthPixels(),d=this._heightPixels();return(void 0===i||null===i||i===!1)&&this._getSeriesData(),this.axes.forEach(function(t){t._scale=null},this),this.axes.forEach(function(t){if(t._min=0,t._max=0,a=[],t._hasMeasure()){var e=!1;this.series.forEach(function(i){if(i._deepMatch(t)){var s=i._axisBounds(t.position);t._min>s.min&&(t._min=s.min),t._max<s.max&&(t._max=s.max),e=!0}},this),e||this._getAllData().forEach(function(e){t._min>e[t.measure]&&(t._min=e[t.measure]),t._max<e[t.measure]&&(t._max=e[t.measure])},this)}else t._hasTimeField()?(t._min=null,t._max=null,this.series.forEach(function(e){e._deepMatch(t)&&null!==e[t.position].timeField&&void 0!==e[t.position].timeField&&-1===a.indexOf(e[t.position].timeField)&&a.push(e[t.position].timeField)},this),t._getAxisData().forEach(function(e){a.forEach(function(i){var s=t._parseDate(e[i]);(null===t._min||s<t._min)&&(t._min=s),(null===t._max||s>t._max)&&(t._max=s)},this)},this)):t._hasCategories()&&(t._min=0,s=[],this.series.forEach(function(e){e._deepMatch(t)&&null!==e[t.position].categoryFields[0]&&void 0!==e[t.position].categoryFields[0]&&-1===a.indexOf(e[t.position].categoryFields[0])&&a.push(e[t.position].categoryFields[0])},this),t._getAxisData().forEach(function(t){a.forEach(function(e){-1===s.indexOf(t[e])&&s.push(t[e])},this)},this),t._max=s.length);null!==t._slaves&&void 0!==t._slaves&&t._slaves.length>0&&t._slaves.forEach(function(e){e._min=t._min,e._max=t._max},this),t._update(),null===r&&"x"===t.position?r=t:null===n&&"y"===t.position&&(n=t)},this),this.axes.forEach(function(i){var s=!1,a=null,g=0,p=null,_=!1,f=0,x={l:null,t:null,r:null,b:null},y=0,m=0,v="",F=this,k=function(t){var i;return i=null===a||0===e||s?t:F._handleTransition(t,e,F)},w=function(){var e=t.select(this).selectAll("text");return!i.measure&&i._max>0&&("x"===i.position?e.attr("x",c/i._max/2):"y"===i.position&&e.attr("y",-1*(d/i._max)/2)),i.categoryFields&&i.categoryFields.length>0&&(i!==r||null!==n.categoryFields&&0!==n.categoryFields.length||e.attr("y",u+d-n._scale(0)+9),i!==n||null!==r.categoryFields&&0!==r.categoryFields.length||e.attr("x",-1*(r._scale(0)-h)-9)),this},C=function(e){return function(){var i=t.select(this).attr("class")||"";return-1===i.indexOf(e)&&(i+=" "+e),i.trim()}};null===i.gridlineShapes?(i.showGridlines||null===i.showGridlines&&!i._hasCategories()&&(!o&&"x"===i.position||!l&&"y"===i.position))&&(i.gridlineShapes=this._group.append("g").attr("class","dimple-gridline"),"x"===i.position?o=!0:l=!0):"x"===i.position?o=!0:l=!0,null===i.shapes&&(i.shapes=this._group.append("g").attr("class","dimple-axis dimple-axis-"+i.position).each(function(){F.noFormats||t.select(this).style("font-family",i.fontFamily).style("font-size",i._getFontSize())}),s=!0),i===r&&null!==n?(a="translate(0, "+(null===n.categoryFields||0===n.categoryFields.length?n._scale(0):u+d)+")",p="translate(0, "+(i===r?u+d:u)+")",g=-d):i===n&&null!==r?(a="translate("+(null===r.categoryFields||0===r.categoryFields.length?r._scale(0):h)+", 0)",p="translate("+(i===n?h:h+c)+", 0)",g=-c):"x"===i.position?(p=a="translate(0, "+(i===r?u+d:u)+")",g=-d):"y"===i.position&&(p=a="translate("+(i===n?h:h+c)+", 0)",g=-c),null!==a&&null!==i._draw&&(i._hasTimeField()?k(i.shapes).call(i._draw.ticks(i._getTimePeriod(),i.timeInterval).tickFormat(i._getFormat())).attr("transform",a).each(w):i.useLog?k(i.shapes).call(i._draw.ticks(4,i._getFormat())).attr("transform",a).each(w):k(i.shapes).call(i._draw.tickFormat(i._getFormat())).attr("transform",a).each(w),null!==i.gridlineShapes&&k(i.gridlineShapes).call(i._draw.tickSize(g,0,0).tickFormat("")).attr("transform",p)),k(i.shapes.selectAll("text")).attr("class",C(F.customClassList.axisLabel)).call(function(){F.noFormats||this.style("font-family",i.fontFamily).style("font-size",i._getFontSize())}),k(i.shapes.selectAll("path, line")).attr("class",C(F.customClassList.axisLine)).call(function(){F.noFormats||this.style("fill","none").style("stroke","black").style("shape-rendering","crispEdges")}),null!==i.gridlineShapes&&k(i.gridlineShapes.selectAll("line")).attr("class",C(F.customClassList.gridline)).call(function(){F.noFormats||this.style("fill","none").style("stroke","lightgray").style("opacity",.8)}),(null===i.measure||void 0===i.measure)&&(i===r?(f=0,i.shapes.selectAll("text").each(function(){var t=this.getComputedTextLength();f=t>f?t:f}),f>c/i.shapes.selectAll("text")[0].length?(_=!0,i.shapes.selectAll("text").style("text-anchor","start").each(function(){var e=this.getBBox();t.select(this).attr("transform","rotate(90,"+e.x+","+(e.y+e.height/2)+") translate(-5, 0)")})):(_=!1,i.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))):"x"===i.position&&(f=0,i.shapes.selectAll("text").each(function(){var t=this.getComputedTextLength();f=t>f?t:f}),f>c/i.shapes.selectAll("text")[0].length?(_=!0,i.shapes.selectAll("text").style("text-anchor","end").each(function(){var e=this.getBBox();t.select(this).attr("transform","rotate(90,"+(e.x+e.width)+","+(e.y+e.height/2)+") translate(5, 0)")})):(_=!1,i.shapes.selectAll("text").style("text-anchor","middle").attr("transform","")))),null!==i.titleShape&&void 0!==i.titleShape&&i.titleShape.remove(),i.shapes.selectAll("text").each(function(){var t=this.getBBox();(null===x.l||-9-t.width<x.l)&&(x.l=-9-t.width),(null===x.r||t.x+t.width>x.r)&&(x.r=t.x+t.width),_?((null===x.t||t.y+t.height-t.width<x.t)&&(x.t=t.y+t.height-t.width),(null===x.b||t.height+t.width>x.b)&&(x.b=t.height+t.width)):((null===x.t||t.y<x.t)&&(x.t=t.y),(null===x.b||9+t.height>x.b)&&(x.b=9+t.height))}),"x"===i.position?(m=i===r?u+d+x.b+5:u+x.t-10,y=h+c/2):"y"===i.position&&(y=i===n?h+x.l-10:h+c+x.r+20,m=u+d/2,v="rotate(270, "+y+", "+m+")"),i.hidden||"x"!==i.position&&"y"!==i.position||null===i.title||(i.titleShape=this._group.append("text").attr("class","dimple-axis dimple-title "+F.customClassList.axisTitle+" dimple-axis-"+i.position),i.titleShape.attr("x",y).attr("y",m).attr("text-anchor","middle").attr("transform",v).text(void 0!==i.title?i.title:null===i.categoryFields||void 0===i.categoryFields||0===i.categoryFields.length?i.measure:i.categoryFields.join("/")).each(function(){F.noFormats||t.select(this).style("font-family",i.fontFamily).style("font-size",i._getFontSize())}),i===r?i.titleShape.each(function(){t.select(this).attr("y",m+this.getBBox().height/1.65)}):i===n&&i.titleShape.each(function(){t.select(this).attr("x",y+this.getBBox().height/1.65)}))},this),this.series.forEach(function(t){t.plot.draw(this,t,e),this._registerEventHandlers(t)},this),this.legends.forEach(function(t){t._draw()},this),this.storyboard&&(this.storyboard._drawText(),this.storyboard.autoplay&&this.storyboard.startAnimation()),this},this.getClass=function(t){return this._assignedClasses[t]||(this._assignedClasses[t]=this.customClassList.colorClasses[this._nextClass],this._nextClass=(this._nextClass+1)%this.customClassList.colorClasses.length),this._assignedClasses[t]},this.getColor=function(t){return(null===this._assignedColors[t]||void 0===this._assignedColors[t])&&(this._assignedColors[t]=this.defaultColors[this._nextColor],this._nextColor=(this._nextColor+1)%this.defaultColors.length),this._assignedColors[t]},this.setBounds=function(t,i,s,a){return this.x=t,this.y=i,this.width=s,this.height=a,this._xPixels=function(){return e._parseXPosition(this.x,this.svg.node())},this.draw(0,!0),this._yPixels=function(){return e._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return e._parseXPosition(this.width,this.svg.node())},this._heightPixels=function(){return e._parseYPosition(this.height,this.svg.node())},this},this.setMargins=function(t,i,s,a){return this.x=t,this.y=i,this.width=0,this.height=0,this._xPixels=function(){return e._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return e._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return e._parentWidth(this.svg.node())-this._xPixels()-e._parseXPosition(s,this.svg.node())},this._heightPixels=function(){return e._parentHeight(this.svg.node())-this._yPixels()-e._parseYPosition(a,this.svg.node())},this.draw(0,!0),this},this.setStoryboard=function(t,i){return this.storyboard=new e.storyboard(this,t),null!==i&&void 0!==i&&(this.storyboard.onTick=i),this.storyboard}},e.color=function(e,i,s){this.fill=e,this.stroke=null===i||void 0===i?t.rgb(e).darker(.5).toString():i,this.opacity=null===s||void 0===s?.8:s},e.eventArgs=function(){this.seriesValue=null,this.xValue=null,this.yValue=null,this.zValue=null,this.pValue=null,this.colorValue=null,this.frameValue=null,this.seriesShapes=null,this.selectedShape=null
},e.legend=function(i,s,a,r,n,o,l){this.chart=i,this.series=l,this.x=s,this.y=a,this.width=r,this.height=n,this.horizontalAlign=o,this.shapes=null,this.fontSize="10px",this.fontFamily="sans-serif",this._draw=function(){var i,s=this._getEntries(),a=0,r=0,n=0,o=0,l=15,h=9,u=this;this.shapes&&this.shapes.remove(),i=this.chart._group.selectAll(".dimple-dont-select-any").data(s).enter().append("g").attr("class",function(t){return"dimple-legend "+e._createClass(t.aggField)}).attr("opacity",1),i.append("text").attr("class",function(t){return"dimple-legend dimple-legend-text "+e._createClass(t.aggField)+" "+u.chart.customClassList.legendLabel}).text(function(t){return t.key}).call(function(){u.chart.noFormats||this.style("font-family",u.fontFamily).style("font-size",u._getFontSize()).style("shape-rendering","crispEdges")}).each(function(){var t=this.getBBox();t.width>a&&(a=t.width),t.height>r&&(r=t.height)}),i.append("rect").attr("class",function(t){return"dimple-legend dimple-legend-key "+e._createClass(t.aggField)}).attr("height",h).attr("width",l),r=(h>r?h:r)+2,a+=l+20,i.each(function(i){n+a>u._widthPixels()&&(n=0,o+=r),o>u._heightPixels()?t.select(this).remove():(t.select(this).select("text").attr("x","left"===u.horizontalAlign?u._xPixels()+l+5+n:u._xPixels()+(u._widthPixels()-n-a)+l+5).attr("y",function(){return u._yPixels()+o+this.getBBox().height/1.65}).attr("width",u._widthPixels()).attr("height",u._heightPixels()),t.select(this).select("rect").attr("class",function(t){return"dimple-legend dimple-legend-key "+e._createClass(t.aggField)+" "+u.chart.customClassList.legendKey+" "+t.css}).attr("x","left"===u.horizontalAlign?u._xPixels()+n:u._xPixels()+(u._widthPixels()-n-a)).attr("y",u._yPixels()+o).attr("height",h).attr("width",l).call(function(){u.chart.noFormats||this.style("fill",i.fill).style("stroke",i.stroke).style("opacity",i.opacity).style("shape-rendering","crispEdges")}),n+=a)}),this.shapes=i},this._getEntries=function(){var t=[];return this.series&&this.series.forEach(function(e){var i=e._positionData;i.forEach(function(i){var s,a=-1,r=e.plot.grouped&&!e.x._hasCategories()&&!e.y._hasCategories()&&i.aggField.length<2?"All":i.aggField.slice(-1)[0];for(s=0;s<t.length;s+=1)if(t[s].key===r){a=s;break}-1===a&&e.chart._assignedColors[r]&&(t.push({key:r,fill:e.chart._assignedColors[r].fill,stroke:e.chart._assignedColors[r].stroke,opacity:e.chart._assignedColors[r].opacity,css:e.chart._assignedClasses[r],series:e,aggField:i.aggField}),a=t.length-1)})},this),t},this._getFontSize=function(){var t;return t=this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._heightPixels=function(){return e._parseYPosition(this.height,this.chart.svg.node())},this._widthPixels=function(){return e._parseXPosition(this.width,this.chart.svg.node())},this._xPixels=function(){return e._parseXPosition(this.x,this.chart.svg.node())},this._yPixels=function(){return e._parseYPosition(this.y,this.chart.svg.node())}},e.series=function(t,e,i,s,a,r,n,o,l,h){this.chart=t,this.x=i,this.y=s,this.z=a,this.c=r,this.p=n,this.plot=o,this.categoryFields=e,this.aggregate=l,this.stacked=h,this.barGap=.2,this.clusterBarGap=.1,this.lineWeight=2,this.lineMarkers=!1,this.afterDraw=null,this.interpolation="linear",this.tooltipFontSize="10px",this.tooltipFontFamily="sans-serif",this.radius="auto",this._eventHandlers=[],this._positionData=[],this._orderRules=[],this._axisBounds=function(t){var e,i,s,a={min:0,max:0},r=null,n=null,o=[],l=0,h=this._positionData;return"x"===t?(r=this.x,n=this.y):"y"===t?(r=this.y,n=this.x):"z"===t?r=this.z:"p"===t?r=this.p:"c"===t&&(r=this.c),r.showPercent?h.forEach(function(t){t[r.position+"Bound"]<a.min&&(a.min=t[r.position+"Bound"]),t[r.position+"Bound"]>a.max&&(a.max=t[r.position+"Bound"])},this):null===n||null===n.categoryFields||0===n.categoryFields.length?h.forEach(function(t){!this._isStacked()||"x"!==r.position&&"y"!==r.position?(t[r.position+"Value"]<a.min&&(a.min=t[r.position+"Value"]),t[r.position+"Value"]>a.max&&(a.max=t[r.position+"Value"])):t[r.position+"Value"]<0?a.min=a.min+t[r.position+"Value"]:a.max=a.max+t[r.position+"Value"]},this):(e=r.position+"Value",i=n.position+"Field",s=[],h.forEach(function(t){var a=t[i].join("/"),r=s.indexOf(a);-1===r&&(s.push(a),r=s.length-1),void 0===o[r]&&(o[r]={min:0,max:0},r>=l&&(l=r+1)),this.stacked?t[e]<0?o[r].min=o[r].min+t[e]:o[r].max=o[r].max+t[e]:(t[e]<o[r].min&&(o[r].min=t[e]),t[e]>o[r].max&&(o[r].max=t[e]))},this),o.forEach(function(t){void 0!==t&&(t.min<a.min&&(a.min=t.min),t.max>a.max&&(a.max=t.max))},this)),a},this._deepMatch=function(t){var e=!1;return this[t.position]===t?e=!0:void 0!==t._slaves&&null!==t._slaves&&t._slaves.length>0&&t._slaves.forEach(function(t){e=e||this._deepMatch(t)},this),e},this._dropLineOrigin=function(){var t=0,e=0,i={x:null,y:null},s={x:null,y:null};return this.chart.axes.forEach(function(t){"x"===t.position&&null===s.x?s.x=t._hasTimeField()?this.chart._xPixels():t._origin:"y"===t.position&&null===s.y&&(s.y=t._hasTimeField()?this.chart._yPixels()+this.chart._heightPixels():t._origin)},this),this.chart.axes.forEach(function(a){"x"!==a.position||this.x.hidden?"y"!==a.position||this.y.hidden||(this._deepMatch(a)&&(0===e?i.x=s.x:1===e&&(i.x=this.chart._xPixels()+this.chart._widthPixels())),e+=1):(this._deepMatch(a)&&(0===t?i.y=s.y:1===t&&(i.y=this.chart._yPixels())),t+=1)},this),i},this._getTooltipFontSize=function(){var t;return t=this.tooltipFontSize&&"auto"!==this.tooltipFontSize.toString().toLowerCase()?isNaN(this.tooltipFontSize)?this.tooltipFontSize:this.tooltipFontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._isStacked=function(){return this.stacked&&(this.x._hasCategories()||this.y._hasCategories())},this.addEventHandler=function(t,e){this._eventHandlers.push({event:t,handler:e})},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})},this.getTooltipText=function(t){var e=[];return null!==this.categoryFields&&void 0!==this.categoryFields&&this.categoryFields.length>0&&this.categoryFields.forEach(function(i,s){null!==i&&void 0!==i&&null!==t.aggField[s]&&void 0!==t.aggField[s]&&e.push(i+(t.aggField[s]!==i?": "+t.aggField[s]:""))},this),this.p?(this.x&&this.x._hasCategories()&&this.x._getTooltipText(e,t),this.y&&this.y._hasCategories()&&this.y._getTooltipText(e,t),this.z&&this.z._hasCategories()&&this.z._getTooltipText(e,t),this.p._getTooltipText(e,t)):(this.x&&this.x._getTooltipText(e,t),this.y&&this.y._getTooltipText(e,t),this.z&&this.z._getTooltipText(e,t)),this.c&&this.c._getTooltipText(e,t),e.filter(function(t,i){return e.indexOf(t)===i})}},e.storyboard=function(t,e){null!==e&&void 0!==e&&(e=[].concat(e)),this.chart=t,this.categoryFields=e,this.autoplay=!0,this.frameDuration=3e3,this.storyLabel=null,this.onTick=null,this.fontSize="10px",this.fontFamily="sans-serif",this._frame=0,this._animationTimer=null,this._categories=[],this._cachedCategoryFields=[],this._orderRules=[],this._drawText=function(){if(!this.storyLabel){var t=this.chart,e=this,i=0;this.chart.axes.forEach(function(t){"x"===t.position&&(i+=1)},this),this.storyLabel=this.chart._group.append("text").attr("class","dimple-storyboard-label").attr("opacity",1).attr("x",this.chart._xPixels()+.01*this.chart._widthPixels()).attr("y",this.chart._yPixels()+(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)*(i>1?1.25:-1)).call(function(){t.noFormats||this.style("font-family",e.fontFamily).style("font-size",e._getFontSize())})}this.storyLabel.text(this.categoryFields.join("\\")+": "+this.getFrameValue())},this._getCategories=function(){return this._categoryFields!==this._cachedCategoryFields&&(this._categories=[],this.chart._getAllData().forEach(function(t){var e=-1,i="";null!==this.categoryFields&&(this.categoryFields.forEach(function(e,s){s>0&&(i+="/"),i+=t[e]},this),e=this._categories.indexOf(i),-1===e&&(this._categories.push(i),e=this._categories.length-1))},this),this._cachedCategoryFields=this._categoryFields),this._categories},this._getFontSize=function(){var t;return t=this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._goToFrameIndex=function(t){this._frame=t%this._getCategories().length,this.chart.draw(this.frameDuration/2)},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})},this.getFrameValue=function(){var t=null;return this._frame>=0&&this._getCategories().length>this._frame&&(t=this._getCategories()[this._frame]),t},this.goToFrame=function(t){if(this._getCategories().length>0){var e=this._getCategories().indexOf(t);this._goToFrameIndex(e)}},this.pauseAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null)},this.startAnimation=function(){null===this._animationTimer&&(null!==this.onTick&&this.onTick(this.getFrameValue()),this._animationTimer=window.setInterval(function(t){return function(){t._goToFrameIndex(t._frame+1),null!==t.onTick&&t.onTick(t.getFrameValue()),t._drawText(t.frameDuration/2)}}(this),this.frameDuration))},this.stopAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null,this._frame=0)}},e.aggregateMethod.avg=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),t.count=null===t.count||void 0===t.count?1:parseFloat(t.count),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),e.count=null===e.count||void 0===e.count?1:parseFloat(e.count),(t.value*t.count+e.value*e.count)/(t.count+e.count)},e.aggregateMethod.count=function(t,e){return t.count=null===t.count||void 0===t.count?0:parseFloat(t.count),e.count=null===e.count||void 0===e.count?0:parseFloat(e.count),t.count+e.count},e.aggregateMethod.max=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),t.value>e.value?t.value:e.value},e.aggregateMethod.min=function(t,e){return parseFloat(null===t.value?e.value:parseFloat(t.value)<parseFloat(e.value)?t.value:e.value)},e.aggregateMethod.sum=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),t.value+e.value},e.plot.area={stacked:!0,grouped:!0,supportedAxes:["x","y","c"],draw:function(i,s,a){var r,n,o,l,h,u,c,d,g,p,_,f,x,y,m,v,F,k,w,C,b,P,B=s._positionData,S=[],M=null,T="dimple-series-"+i.series.indexOf(s),z=s.x._hasCategories()||s.y._hasCategories()?0:1,O=!1,V={},L=[],A=[],G=function(){return function(i,s,a,r){t.select(s).style("opacity",1),e._showPointTooltip(i,s,a,r)}},D=function(i){return function(s,a,r,n){t.select(a).style("opacity",n.lineMarkers||i.data.length<2?e._helpers.opacity(s,r,n):0),e._removeTooltip(s,a,r,n)}},E=function(t,r){e._drawMarkers(t,i,s,a,T,O,G(t),D(t),r)},j=function(t,a){var r;return"step"===s.interpolation&&s[t]._hasCategories()?(r=e._helpers[t](a,i,s)+("y"===t?e._helpers.height(a,i,s):0),s[t].categoryFields.length<2&&(r+=("y"===t?1:-1)*e._helpers[t+"Gap"](i,s))):r=e._helpers["c"+t](a,i,s),parseFloat(r)},R=function(e,i){return t.svg.line().x(function(t){return s.x._hasCategories()||!i?t.x:s.x[i]}).y(function(t){return s.y._hasCategories()||!i?t.y:s.y[i]}).interpolate(e)},N=function(t,e){return parseFloat(t)-parseFloat(e)},W=function(t,e){return parseFloat(t.x)-parseFloat(e.x)},H=function(t,e,i){var s,a,r=e[e.length-1],n=9999,o=r;for(s=0;s<t.length;s+=1)(t[s].x!==r.x||t[s].y!==r.y)&&(a=180-Math.atan2(t[s].x-r.x,t[s].y-r.y)*(180/Math.PI),a>i&&n>a&&(o=t[s],n=a));return e.push(o),n};for(r="step"===s.interpolation?"step-after":s.interpolation,p=e._getSeriesOrder(s.data||i.data,s),s.c&&(s.x._hasCategories()&&s.y._hasMeasure()||s.y._hasCategories()&&s.x._hasMeasure())&&(O=!0),s.x._hasCategories()?(b="x",P="y"):s.y._hasCategories()&&(b="y",P="x"),n=0;n<B.length;n+=1){for(h=[],c=-1,l=z;l<B[n].aggField.length;l+=1)h.push(B[n].aggField[l]);for(u=e._createClass(h),l=0;l<S.length;l+=1)if(S[l].keyString===u){c=l;break}-1===c&&(c=S.length,S.push({key:h,keyString:u,color:"white",data:[],points:[],area:{},entry:{},exit:{},group:b&&B[n][b+"Field"]&&B[n][b+"Field"].length>=2?B[n][b+"Field"][0]:"All"})),S[c].data.push(B[n])}for(p&&S.sort(function(t,i){return e._arrayIndexCompare(p,t.key,i.key)}),n=0;n<S.length;n+=1){for(S[n].data.sort(e._getSeriesSortPredicate(i,s,p)),o=0;o<S[n].data.length;o+=1)S[n].points.push({x:j("x",S[n].data[o]),y:j("y",S[n].data[o])}),b&&(V[S[n].group]||(V[S[n].group]={}),V[S[n].group][S[n].points[S[n].points.length-1][b]]=s[P]._origin);_=S[n].points,"step"===s.interpolation&&_.length>1&&b&&(s.x._hasCategories()?(_.push({x:2*_[_.length-1].x-_[_.length-2].x,y:_[_.length-1].y}),V[S[n].group][_[_.length-1][b]]=s[P]._origin):s.y._hasCategories()&&(_=[{x:_[0].x,y:2*_[0].y-_[1].y}].concat(_),V[S[n].group][_[0][b]]=s[P]._origin,S[n].points=_))}for(y in V)if(V.hasOwnProperty(y)){L[y]=[];for(m in V[y])V[y].hasOwnProperty(m)&&L[y].push(parseFloat(m));L[y].sort(N)}for(n=0;n<S.length;n+=1){if(_=S[n].points,v=S[n].group,f=[],A=[],O&&e._addGradient(S[n].key,"fill-area-gradient-"+S[n].keyString,s.x._hasCategories()?s.x:s.y,B,i,a,"fill"),L[v]&&L[v].length>0)for(o=0,l=0;o<L[v].length;o+=1)L[v][o]>=_[0][b]&&L[v][o]<=_[_.length-1][b]&&(x={},x[b]=L[v][o],x[P]=V[v][L[v][o]],f.push(x),_[l][b]>L[v][o]?A.push(x):(A.push(_[l]),V[S[n].group][L[v][o]]=_[l][P],l+=1));else if(s._orderRules&&s._orderRules.length>0)A=_.concat(_[0]);else{_=_.sort(W),A.push(_[0]),C=0;do C=H(_,A,C);while(A.length<=_.length&&(A[0].x!==A[A.length-1].x||A[0].y!==A[A.length-1].y))}f=f.reverse(),F=R(r,"_previousOrigin")(A),k=R("step-after"===r?"step-before":"step-before"===r?"step-after":r,"_previousOrigin")(f),w=R("linear","_previousOrigin")(A),S[n].entry=F+(k&&k.length>0?"L"+k.substring(1):"")+(w&&w.length>0?"L"+w.substring(1,w.indexOf("L")):0),F=R(r)(A),k=R("step-after"===r?"step-before":"step-before"===r?"step-after":r)(f),w=R("linear")(A),S[n].update=F+(k&&k.length>0?"L"+k.substring(1):"")+(w&&w.length>0?"L"+w.substring(1,w.indexOf("L")):0),F=R(r,"_origin")(A),k=R("step-after"===r?"step-before":"step-before"===r?"step-after":r,"_origin")(f),w=R("linear","_origin")(A),S[n].exit=F+(k&&k.length>0?"L"+k.substring(1):"")+(w&&w.length>0?"L"+w.substring(1,w.indexOf("L")):0),S[n].color=i.getColor(S[n].key.length>0?S[n].key[S[n].key.length-1]:"All"),S[n].css=i.getClass(S[n].key.length>0?S[n].key[S[n].key.length-1]:"All")}null!==i._tooltipGroup&&void 0!==i._tooltipGroup&&i._tooltipGroup.remove(),M=null===s.shapes||void 0===s.shapes?i._group.selectAll("."+T).data(S):s.shapes.data(S,function(t){return t.key}),M.enter().append("path").attr("id",function(t){return e._createClass([t.key])}).attr("class",function(t){return T+" dimple-line "+t.keyString+" "+i.customClassList.areaSeries+" "+t.css}).attr("d",function(t){return t.entry}).call(function(){i.noFormats||this.attr("opacity",function(t){return O?1:t.color.opacity}).style("fill",function(t){return O?"url(#fill-area-gradient-"+t.keyString+")":t.color.fill}).style("stroke",function(t){return O?"url(#stroke-area-gradient-"+t.keyString+")":t.color.stroke}).style("stroke-width",s.lineWeight)}).each(function(t){t.markerData=t.data,E(t,this)}),d=i._handleTransition(M,a,i).attr("d",function(t){return t.update}).each(function(t){t.markerData=t.data,E(t,this)}),g=i._handleTransition(M.exit(),a,i).attr("d",function(t){return t.exit}).each(function(t){t.markerData=[],E(t,this)}),e._postDrawHandling(s,d,g,a),s.shapes=M}},e.plot.bar={stacked:!0,grouped:!1,supportedAxes:["x","y","c"],draw:function(t,i,s){var a,r,n=i._positionData,o=null,l=["dimple-series-"+t.series.indexOf(i),"dimple-bar"],h=!i._isStacked()&&i.x._hasMeasure(),u=!i._isStacked()&&i.y._hasMeasure(),c="none";i.x._hasCategories()&&i.y._hasCategories()?c="both":i.x._hasCategories()?c="x":i.y._hasCategories()&&(c="y"),null!==t._tooltipGroup&&void 0!==t._tooltipGroup&&t._tooltipGroup.remove(),o=null===i.shapes||void 0===i.shapes?t._group.selectAll("."+l.join(".")).data(n):i.shapes.data(n,function(t){return t.key}),o.enter().append("rect").attr("id",function(t){return e._createClass([t.key])}).attr("class",function(i){var s=[];return s=s.concat(i.aggField),s=s.concat(i.xField),s=s.concat(i.yField),l.join(" ")+" "+e._createClass(s)+" "+t.customClassList.barSeries+" "+e._helpers.css(i,t)}).attr("x",function(s){var a=i.x._previousOrigin;return"x"===c?a=e._helpers.x(s,t,i):"both"===c&&(a=e._helpers.cx(s,t,i)),a}).attr("y",function(s){var a=i.y._previousOrigin;return"y"===c?a=e._helpers.y(s,t,i):"both"===c&&(a=e._helpers.cy(s,t,i)),a}).attr("width",function(s){return"x"===c?e._helpers.width(s,t,i):0}).attr("height",function(s){return"y"===c?e._helpers.height(s,t,i):0}).on("mouseover",function(s){e._showBarTooltip(s,this,t,i)}).on("mouseleave",function(s){e._removeTooltip(s,this,t,i)}).call(function(){t.noFormats||this.attr("opacity",function(s){return e._helpers.opacity(s,t,i)}).style("fill",function(s){return e._helpers.fill(s,t,i)}).style("stroke",function(s){return e._helpers.stroke(s,t,i)})}),a=t._handleTransition(o,s,t,i).attr("x",function(s){return h?e._helpers.cx(s,t,i)-i.x.floatingBarWidth/2:e._helpers.x(s,t,i)}).attr("y",function(s){return u?e._helpers.cy(s,t,i)-i.y.floatingBarWidth/2:e._helpers.y(s,t,i)}).attr("width",function(s){return h?i.x.floatingBarWidth:e._helpers.width(s,t,i)}).attr("height",function(s){return u?i.y.floatingBarWidth:e._helpers.height(s,t,i)}).call(function(){t.noFormats||this.attr("fill",function(s){return e._helpers.fill(s,t,i)}).attr("stroke",function(s){return e._helpers.stroke(s,t,i)})}),r=t._handleTransition(o.exit(),s,t,i).attr("x",function(s){var a=i.x._origin;return"x"===c?a=e._helpers.x(s,t,i):"both"===c&&(a=e._helpers.cx(s,t,i)),isNaN(a)?300:a}).attr("y",function(s){var a=i.y._origin;return"y"===c?a=e._helpers.y(s,t,i):"both"===c&&(a=e._helpers.cy(s,t,i)),isNaN(a)?0:a}).attr("width",function(s){return"x"===c?e._helpers.width(s,t,i):0}).attr("height",function(s){return"y"===c?e._helpers.height(s,t,i):0}),e._postDrawHandling(i,a,r,s),i.shapes=o}},e.plot.bubble={stacked:!1,grouped:!1,supportedAxes:["x","y","z","c"],draw:function(t,i,s){var a,r,n=i._positionData,o=null,l=["dimple-series-"+t.series.indexOf(i),"dimple-bubble"];null!==t._tooltipGroup&&void 0!==t._tooltipGroup&&t._tooltipGroup.remove(),o=null===i.shapes||void 0===i.shapes?t._group.selectAll("."+l.join(".")).data(n):i.shapes.data(n,function(t){return t.key}),o.enter().append("circle").attr("id",function(t){return e._createClass([t.key])}).attr("class",function(i){var s=[];return s=s.concat(i.aggField),s=s.concat(i.xField),s=s.concat(i.yField),s=s.concat(i.zField),l.join(" ")+" "+e._createClass(s)+" "+t.customClassList.bubbleSeries+" "+e._helpers.css(i,t)}).attr("cx",function(s){return i.x._hasCategories()?e._helpers.cx(s,t,i):i.x._previousOrigin}).attr("cy",function(s){return i.y._hasCategories()?e._helpers.cy(s,t,i):i.y._previousOrigin}).attr("r",0).on("mouseover",function(s){e._showPointTooltip(s,this,t,i)}).on("mouseleave",function(s){e._removeTooltip(s,this,t,i)}).call(function(){t.noFormats||this.attr("opacity",function(s){return e._helpers.opacity(s,t,i)}).style("fill",function(s){return e._helpers.fill(s,t,i)}).style("stroke",function(s){return e._helpers.stroke(s,t,i)})}),a=t._handleTransition(o,s,t,i).attr("cx",function(s){return e._helpers.cx(s,t,i)}).attr("cy",function(s){return e._helpers.cy(s,t,i)}).attr("r",function(s){return e._helpers.r(s,t,i)}).call(function(){t.noFormats||this.attr("fill",function(s){return e._helpers.fill(s,t,i)}).attr("stroke",function(s){return e._helpers.stroke(s,t,i)})}),r=t._handleTransition(o.exit(),s,t,i).attr("r",0).attr("cx",function(s){return i.x._hasCategories()?e._helpers.cx(s,t,i):i.x._origin}).attr("cy",function(s){return i.y._hasCategories()?e._helpers.cy(s,t,i):i.y._origin}),e._postDrawHandling(i,a,r,s),i.shapes=o}},e.plot.line={stacked:!1,grouped:!0,supportedAxes:["x","y","c"],draw:function(i,s,a){var r,n,o,l,h,u,c,d,g,p,_=s._positionData,f=[],x=null,y="dimple-series-"+i.series.indexOf(s),m=s.x._hasCategories()||s.y._hasCategories()?0:1,v=!1,F=function(){return function(i,s,a,r){t.select(s).style("opacity",1),e._showPointTooltip(i,s,a,r)}},k=function(i){return function(s,a,r,n){t.select(a).style("opacity",n.lineMarkers||i.data.length<2?e._helpers.opacity(s,r,n):0),e._removeTooltip(s,a,r,n)}},w=function(t,r){e._drawMarkers(t,i,s,a,y,v,F(t),k(t),r)},C=function(t,a){var r;return"step"===s.interpolation&&s[t]._hasCategories()?(s.barGap=0,s.clusterBarGap=0,r=e._helpers[t](a,i,s)+("y"===t?e._helpers.height(a,i,s):0)):r=e._helpers["c"+t](a,i,s),parseFloat(r.toFixed(1))},b=function(e,i){return t.svg.line().x(function(t){return s.x._hasCategories()||!i?t.x:s.x[i]}).y(function(t){return s.y._hasCategories()||!i?t.y:s.y[i]}).interpolate(e)};for(r="step"===s.interpolation?"step-after":s.interpolation,p=e._getSeriesOrder(s.data||i.data,s),s.c&&(s.x._hasCategories()&&s.y._hasMeasure()||s.y._hasCategories()&&s.x._hasMeasure())&&(v=!0),n=0;n<_.length;n+=1){for(h=[],c=-1,l=m;l<_[n].aggField.length;l+=1)h.push(_[n].aggField[l]);for(u=e._createClass(h),l=0;l<f.length;l+=1)if(f[l].keyString===u){c=l;break}-1===c&&(c=f.length,f.push({key:h,keyString:u,color:"white",data:[],markerData:[],points:[],line:{},entry:{},exit:{}})),f[c].data.push(_[n])}for(p&&f.sort(function(t,i){return e._arrayIndexCompare(p,t.key,i.key)}),n=0;n<f.length;n+=1){for(f[n].data.sort(e._getSeriesSortPredicate(i,s,p)),v&&e._addGradient(f[n].key,"fill-line-gradient-"+f[n].keyString,s.x._hasCategories()?s.x:s.y,_,i,a,"fill"),o=0;o<f[n].data.length;o+=1)f[n].points.push({x:C("x",f[n].data[o]),y:C("y",f[n].data[o])});"step"===s.interpolation&&f[n].points.length>1&&(s.x._hasCategories()?f[n].points.push({x:2*f[n].points[f[n].points.length-1].x-f[n].points[f[n].points.length-2].x,y:f[n].points[f[n].points.length-1].y}):s.y._hasCategories()&&(f[n].points=[{x:f[n].points[0].x,y:2*f[n].points[0].y-f[n].points[1].y}].concat(f[n].points))),f[n].entry=b(r,"_previousOrigin")(f[n].points),f[n].update=b(r)(f[n].points),f[n].exit=b(r,"_origin")(f[n].points),f[n].color=i.getColor(f[n].key.length>0?f[n].key[f[n].key.length-1]:"All"),f[n].css=i.getClass(f[n].key.length>0?f[n].key[f[n].key.length-1]:"All")}null!==i._tooltipGroup&&void 0!==i._tooltipGroup&&i._tooltipGroup.remove(),x=null===s.shapes||void 0===s.shapes?i._group.selectAll("."+y).data(f):s.shapes.data(f,function(t){return t.key}),x.enter().append("path").attr("id",function(t){return e._createClass([t.key])}).attr("class",function(t){return y+" dimple-line "+t.keyString+" "+i.customClassList.lineSeries+" "+t.css}).attr("d",function(t){return t.entry}).call(function(){i.noFormats||this.attr("opacity",function(t){return v?1:t.color.opacity}).style("fill","none").style("stroke",function(t){return v?"url(#fill-line-gradient-"+t.keyString+")":t.color.stroke}).style("stroke-width",s.lineWeight)}).each(function(t){t.markerData=t.data,w(t,this)}),d=i._handleTransition(x,a,i).attr("d",function(t){return t.update}).each(function(t){t.markerData=t.data,w(t,this)}),g=i._handleTransition(x.exit(),a,i).attr("d",function(t){return t.exit}).each(function(t){t.markerData=[],w(t,this)}),e._postDrawHandling(s,d,g,a),s.shapes=x}},e.plot.pie={stacked:!1,grouped:!1,supportedAxes:["x","y","c","z","p"],draw:function(i,s,a){var r,n,o=s._positionData,l=null,h=["dimple-series-"+i.series.indexOf(s),"dimple-pie"],u=function(t){var a;return a=s.x&&s.y?e._helpers.r(t,i,s):i._widthPixels()<i._heightPixels()?i._widthPixels()/2:i._heightPixels()/2},c=function(t){var i=u(t);return s.outerRadius&&(i=e._parsePosition(s.outerRadius,i)),Math.max(i,0)},d=function(t){var i=0;return s.innerRadius&&(i=e._parsePosition(s.innerRadius,u(t))),Math.max(i,0)},g=function(e){var i;return(i=t.svg.arc().innerRadius(d(e)).outerRadius(c(e)))(e)},p=function(e){e.innerRadius=d(e),e.outerRadius=c(e);var i,s=t.interpolate(this._current,e);return i=t.svg.arc().innerRadius(function(t){return t.innerRadius}).outerRadius(function(t){return t.outerRadius}),this._current=s(0),function(t){return i(s(t))}},_=function(t){return function(a){var r,n;return s.x&&s.y?(r=!t||s.x._hasCategories()?e._helpers.cx(a,i,s):s.x._previousOrigin,n=!t||s.y._hasCategories()?e._helpers.cy(a,i,s):s.y._previousOrigin):(r=i._xPixels()+i._widthPixels()/2,n=i._yPixels()+i._heightPixels()/2),"translate("+r+","+n+")"}};null!==i._tooltipGroup&&void 0!==i._tooltipGroup&&i._tooltipGroup.remove(),l=null===s.shapes||void 0===s.shapes?i._group.selectAll("."+h.join(".")).data(o):s.shapes.data(o,function(t){return t.key}),l.enter().append("path").attr("id",function(t){return e._createClass([t.key])}).attr("class",function(t){var s=[];return s=s.concat(t.aggField),s=s.concat(t.pField),h.join(" ")+" "+e._createClass(s)+" "+i.customClassList.pieSeries+" "+e._helpers.css(t,i)}).attr("d",g).on("mouseover",function(t){e._showBarTooltip(t,this,i,s)}).on("mouseleave",function(t){e._removeTooltip(t,this,i,s)}).call(function(){i.noFormats||this.attr("opacity",function(t){return e._helpers.opacity(t,i,s)}).style("fill",function(t){return e._helpers.fill(t,i,s)}).style("stroke",function(t){return e._helpers.stroke(t,i,s)})}).attr("transform",_(!0)).each(function(t){this._current=t,t.innerRadius=d(t),t.outerRadius=c(t)}),r=i._handleTransition(l,a,i,s).call(function(){a&&a>0?this.attrTween("d",p):this.attr("d",g),i.noFormats||this.attr("fill",function(t){return e._helpers.fill(t,i,s)}).attr("stroke",function(t){return e._helpers.stroke(t,i,s)})}).attr("transform",_(!1)),n=i._handleTransition(l.exit(),a,i,s).attr("transform",_(!0)).attr("d",g),e._postDrawHandling(s,r,n,a),s.shapes=l}},e._addGradient=function(t,i,s,a,r,n,o){var l=[].concat(t),h=r._group.select("#"+i),u=[],c=s.position+"Field",d=!0,g=[];a.forEach(function(t){-1===u.indexOf(t[c])&&t.aggField.join("_")===l.join("_")&&u.push(t[c])},this),u=u.sort(function(t,e){return s._scale(t)-s._scale(e)}),null===h.node()&&(d=!1,h=r._group.append("linearGradient").attr("id",e._createClass([i])).attr("gradientUnits","userSpaceOnUse").attr("x1","x"===s.position?s._scale(u[0])+r._widthPixels()/u.length/2:0).attr("y1","y"===s.position?s._scale(u[0])-r._heightPixels()/u.length/2:0).attr("x2","x"===s.position?s._scale(u[u.length-1])+r._widthPixels()/u.length/2:0).attr("y2","y"===s.position?s._scale(u[u.length-1])-r._heightPixels()/u.length/2:0)),u.forEach(function(t,e){var i={},s=0;for(s=0;s<a.length;s+=1)if(a[s].aggField.join("_")===l.join("_")&&a[s][c].join("_")===t.join("_")){i=a[s];break}g.push({offset:Math.round(e/(u.length-1)*100)+"%",color:i[o]})},this),d?r._handleTransition(h.selectAll("stop").data(g),n,r).attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color}):h.selectAll("stop").data(g).enter().append("stop").attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color})},e._arrayIndexCompare=function(t,e,i){var s,a,r,n,o,l;for(a=0;a<t.length;a+=1){for(n=!0,o=!0,l=[].concat(t[a]),r=0;r<e.length;r+=1)n=n&&e[r]===l[r];for(r=0;r<i.length;r+=1)o=o&&i[r]===l[r];if(n&&o){s=0;break}if(n){s=-1;break}if(o){s=1;break}}return s},e._createClass=function(t){var e,i=[],s=function(t){var e=t.charCodeAt(0),i="-";return e>=65&&90>=e&&(i=t.toLowerCase()),i};if(t.length>0)for(e=0;e<t.length;e+=1)i.push("dimple-"+t[e].toString().replace(/[^a-z0-9]/g,s));else i=["dimple-all"];return i.join(" ")},e._drawMarkerBacks=function(i,s,a,r,n,o){var l,h,u,c=["dimple-marker-back",n,i.keyString];a.lineMarkers&&(l=null===a._markerBacks||void 0===a._markerBacks||void 0===a._markerBacks[i.keyString]?s._group.selectAll("."+c.join(".")).data(i.markerData):a._markerBacks[i.keyString].data(i.markerData,function(t){return t.key}),u=o.nextSibling&&o.nextSibling.id?l.enter().insert("circle","#"+o.nextSibling.id):l.enter().append("circle"),u.attr("id",function(t){return e._createClass([t.key+" Marker Back"])}).attr("class",function(t){var i=[];return a.x._hasCategories()&&(i=i.concat(t.xField)),a.y._hasCategories()&&(i=i.concat(t.yField)),e._createClass(i)+" "+c.join(" ")}).attr("cx",function(t){return a.x._hasCategories()?e._helpers.cx(t,s,a):a.x._previousOrigin}).attr("cy",function(t){return a.y._hasCategories()?e._helpers.cy(t,s,a):a.y._previousOrigin}).attr("r",0).attr("fill","white").attr("stroke","none"),s._handleTransition(l,r,s).attr("cx",function(t){return e._helpers.cx(t,s,a)}).attr("cy",function(t){return e._helpers.cy(t,s,a)}).attr("r",2+a.lineWeight),h=s._handleTransition(l.exit(),r,s).attr("cx",function(t){return a.x._hasCategories()?e._helpers.cx(t,s,a):a.x._origin}).attr("cy",function(t){return a.y._hasCategories()?e._helpers.cy(t,s,a):a.y._origin}).attr("r",0),0===r?h.remove():h.each("end",function(){t.select(this).remove()}),(void 0===a._markerBacks||null===a._markerBacks)&&(a._markerBacks={}),a._markerBacks[i.keyString]=l)},e._drawMarkers=function(i,s,a,r,n,o,l,h,u){var c,d,g,p=["dimple-marker",n,i.keyString];c=null===a._markers||void 0===a._markers||void 0===a._markers[i.keyString]?s._group.selectAll("."+p.join(".")).data(i.markerData):a._markers[i.keyString].data(i.markerData,function(t){return t.key}),g=u.nextSibling&&u.nextSibling.id?c.enter().insert("circle","#"+u.nextSibling.id):c.enter().append("circle"),g.attr("id",function(t){return e._createClass([t.key+" Marker"])}).attr("class",function(t){var i=[],r=s.getClass(t.aggField.length>0?t.aggField[t.aggField.length-1]:"All");return a.x._hasCategories()&&(i=i.concat(t.xField)),a.y._hasCategories()&&(i=i.concat(t.yField)),e._createClass(i)+" "+p.join(" ")+" "+s.customClassList.lineMarker+" "+r}).on("mouseover",function(t){l(t,this,s,a)}).on("mouseleave",function(t){h(t,this,s,a)}).attr("cx",function(t){return a.x._hasCategories()?e._helpers.cx(t,s,a):a.x._previousOrigin}).attr("cy",function(t){return a.y._hasCategories()?e._helpers.cy(t,s,a):a.y._previousOrigin}).attr("r",0).attr("opacity",a.lineMarkers||i.data.length<2?i.color.opacity:0).call(function(){s.noFormats||this.attr("fill","white").style("stroke-width",a.lineWeight).attr("stroke",function(t){return o?e._helpers.fill(t,s,a):i.color.stroke})}),s._handleTransition(c,r,s).attr("cx",function(t){return e._helpers.cx(t,s,a)}).attr("cy",function(t){return e._helpers.cy(t,s,a)}).attr("r",2+a.lineWeight).attr("opacity",a.lineMarkers||i.data.length<2?i.color.opacity:0).call(function(){s.noFormats||this.attr("fill","white").style("stroke-width",a.lineWeight).attr("stroke",function(t){return o?e._helpers.fill(t,s,a):i.color.stroke})}),d=s._handleTransition(c.exit(),r,s).attr("cx",function(t){return a.x._hasCategories()?e._helpers.cx(t,s,a):a.x._origin}).attr("cy",function(t){return a.y._hasCategories()?e._helpers.cy(t,s,a):a.y._origin}).attr("r",0),0===r?d.remove():d.each("end",function(){t.select(this).remove()}),(void 0===a._markers||null===a._markers)&&(a._markers={}),a._markers[i.keyString]=c,e._drawMarkerBacks(i,s,a,r,n,u)},e._getOrderedList=function(t,i,s){var a,r=[],n=[],o=[].concat(i),l=[].concat(i),h=[];return null!==s&&void 0!==s&&(h=h.concat(s)),h=h.concat({ordering:o,desc:!1}),h.forEach(function(e){var i,s=[],a=[];if("function"==typeof e.ordering){if(t&&t.length>0)for(i in t[0])t[0].hasOwnProperty(i)&&-1===l.indexOf(i)&&l.push(i)}else if(e.ordering instanceof Array){for(i=0;i<e.ordering.length;i+=1)t&&t.length>0&&t[0].hasOwnProperty(e.ordering[i])&&a.push(e.ordering[i]),s.push(e.ordering[i]);a.length>s.length/2?l.concat(a):e.values=s}else l.push(e.ordering)},this),a=e._rollUp(t,o,l),h.length>=1&&(h.forEach(function(t){var e=null===t.desc||void 0===t.desc?!1:t.desc,i=t.ordering,s=[],a=function(t){var e,i=0;for(e=0;e<t.length;e+=1){if(isNaN(t[e])){i=void 0;break}i+=parseFloat(t[e])}return i},n=function(t,e){var i=0,s=a(t),r=a(e);return isNaN(s)||isNaN(r)?isNaN(Date.parse(t[0]))||isNaN(Date.parse(e[0]))?t[0]<e[0]?i=-1:t[0]>e[0]&&(i=1):i=Date.parse(t[0])-Date.parse(e[0]):i=parseFloat(s)-parseFloat(r),i
};"function"==typeof i?r.push(function(t,s){return(e?-1:1)*i(t,s)}):t.values&&t.values.length>0?(t.values.forEach(function(t){s.push([].concat(t).join("|"))},this),r.push(function(t,i){var a,r,n,l="",h="";for(n=0;n<o.length;n+=1)n>0&&(l+="|",h+="|"),l+=t[o[n]],h+=i[o[n]];return a=s.indexOf(l),r=s.indexOf(h),a=0>a?e?-1:s.length:a,r=0>r?e?-1:s.length:r,(e?-1:1)*(a-r)})):[].concat(t.ordering).forEach(function(t){r.push(function(i,s){var a=0;return void 0!==i[t]&&void 0!==s[t]&&(a=n([].concat(i[t]),[].concat(s[t]))),(e?-1:1)*a})})}),a.sort(function(t,e){for(var i=0,s=0;i<r.length&&0===s;)s=r[i](t,e),i+=1;return s}),a.forEach(function(t){var e,i=[];if(1===o.length)n.push(t[o[0]]);else{for(e=0;e<o.length;e+=1)i.push(t[o[e]]);n.push(i)}},this)),n},e._getSeriesOrder=function(t,i){var s=[].concat(i._orderRules),a=i.categoryFields,r=[];return null!==a&&void 0!==a&&a.length>0&&(null!==i.c&&void 0!==i.c&&i.c._hasMeasure()&&s.push({ordering:i.c.measure,desc:!0}),i.x._hasMeasure()&&s.push({ordering:i.x.measure,desc:!0}),i.y._hasMeasure()&&s.push({ordering:i.y.measure,desc:!0}),r=e._getOrderedList(t,a,s)),r},e._getSeriesSortPredicate=function(t,i,s){return function(a,r){var n=0;return i.x._hasCategories()&&(n=e._helpers.cx(a,t,i)-e._helpers.cx(r,t,i)),0===n&&i.y._hasCategories()&&(n=e._helpers.cy(a,t,i)-e._helpers.cy(r,t,i)),0===n&&s&&(n=e._arrayIndexCompare(s,a.aggField,r.aggField)),n}},e._helpers={cx:function(t,i,s){var a=0;return a=null!==s.x.measure&&void 0!==s.x.measure?s.x._scale(t.cx):s.x._hasCategories()&&s.x.categoryFields.length>=2?s.x._scale(t.cx)+e._helpers.xGap(i,s)+(t.xOffset+.5)*(i._widthPixels()/s.x._max-2*e._helpers.xGap(i,s))*t.width:s.x._scale(t.cx)+i._widthPixels()/s.x._max/2},cy:function(t,i,s){var a=0;return a=null!==s.y.measure&&void 0!==s.y.measure?s.y._scale(t.cy):null!==s.y.categoryFields&&void 0!==s.y.categoryFields&&s.y.categoryFields.length>=2?s.y._scale(t.cy)-i._heightPixels()/s.y._max+e._helpers.yGap(i,s)+(t.yOffset+.5)*(i._heightPixels()/s.y._max-2*e._helpers.yGap(i,s))*t.height:s.y._scale(t.cy)-i._heightPixels()/s.y._max/2},r:function(t,e,i){var s=0,a=1;return null===i.z||void 0===i.z?s=i.radius&&"auto"!==i.radius?i.radius:5:(i.radius&&"auto"!==i.radius&&i.radius>1&&(a=i.radius/i.z._scale(i.z._max)),s=i.z._hasMeasure()?i.z._scale(t.r)*a:i.z._scale(e._heightPixels()/100)*a),s},xGap:function(t,e){var i=0;return(null===e.x.measure||void 0===e.x.measure)&&e.barGap>0&&(i=t._widthPixels()/e.x._max*(e.barGap>.99?.99:e.barGap)/2),i},xClusterGap:function(t,i,s){var a=0;return null!==s.x.categoryFields&&void 0!==s.x.categoryFields&&s.x.categoryFields.length>=2&&s.clusterBarGap>0&&!s.x._hasMeasure()&&(a=t.width*(i._widthPixels()/s.x._max-2*e._helpers.xGap(i,s))*(s.clusterBarGap>.99?.99:s.clusterBarGap)/2),a},yGap:function(t,e){var i=0;return(null===e.y.measure||void 0===e.y.measure)&&e.barGap>0&&(i=t._heightPixels()/e.y._max*(e.barGap>.99?.99:e.barGap)/2),i},yClusterGap:function(t,i,s){var a=0;return null!==s.y.categoryFields&&void 0!==s.y.categoryFields&&s.y.categoryFields.length>=2&&s.clusterBarGap>0&&!s.y._hasMeasure()&&(a=t.height*(i._heightPixels()/s.y._max-2*e._helpers.yGap(i,s))*(s.clusterBarGap>.99?.99:s.clusterBarGap)/2),a},x:function(t,i,s){var a=0;return a=s.x._hasTimeField()?s.x._scale(t.x)-e._helpers.width(t,i,s)/2:null!==s.x.measure&&void 0!==s.x.measure?s.x._scale(t.x):s.x._scale(t.x)+e._helpers.xGap(i,s)+t.xOffset*(e._helpers.width(t,i,s)+2*e._helpers.xClusterGap(t,i,s))+e._helpers.xClusterGap(t,i,s)},y:function(t,i,s){var a=0;return a=s.y._hasTimeField()?s.y._scale(t.y)-e._helpers.height(t,i,s)/2:null!==s.y.measure&&void 0!==s.y.measure?s.y._scale(t.y):s.y._scale(t.y)-i._heightPixels()/s.y._max+e._helpers.yGap(i,s)+t.yOffset*(e._helpers.height(t,i,s)+2*e._helpers.yClusterGap(t,i,s))+e._helpers.yClusterGap(t,i,s)},width:function(t,i,s){var a=0;return a=null!==s.x.measure&&void 0!==s.x.measure?Math.abs(s.x._scale(t.x<0?t.x-t.width:t.x+t.width)-s.x._scale(t.x)):s.x._hasTimeField()?s.x.floatingBarWidth:t.width*(i._widthPixels()/s.x._max-2*e._helpers.xGap(i,s))-2*e._helpers.xClusterGap(t,i,s)},height:function(t,i,s){var a=0;return a=s.y._hasTimeField()?s.y.floatingBarWidth:null!==s.y.measure&&void 0!==s.y.measure?Math.abs(s.y._scale(t.y)-s.y._scale(t.y<=0?t.y+t.height:t.y-t.height)):t.height*(i._heightPixels()/s.y._max-2*e._helpers.yGap(i,s))-2*e._helpers.yClusterGap(t,i,s)},opacity:function(t,e,i){var s=0;return s=null!==i.c&&void 0!==i.c?t.opacity:e.getColor(t.aggField.slice(-1)[0]).opacity},fill:function(t,e,i){var s=0;return s=null!==i.c&&void 0!==i.c?t.fill:e.getColor(t.aggField.slice(-1)[0]).fill},stroke:function(t,e,i){var s=0;return s=null!==i.c&&void 0!==i.c?t.stroke:e.getColor(t.aggField.slice(-1)[0]).stroke},css:function(t,e){return e.getClass(t.aggField.slice(-1)[0])}},e._parentHeight=function(t){var i=t.offsetHeight;return(0>=i||null===i||void 0===i)&&(i=t.clientHeight),(0>=i||null===i||void 0===i)&&(i=null===t.parentNode||void 0===t.parentNode?0:e._parentHeight(t.parentNode)),i},e._parentWidth=function(t){var i=t.offsetWidth;return(!i||0>i)&&(i=t.clientWidth),(!i||0>i)&&(i=t.parentNode?e._parentWidth(t.parentNode):0),i},e._parsePosition=function(t,e){var i,s=0;return t&&(i=t.toString().split(","),i.forEach(function(i){i&&(isNaN(i)?"%"===i.slice(-1)?s+=e*(parseFloat(i.slice(0,i.length-1))/100):"px"===i.slice(-2)?s+=parseFloat(i.slice(0,i.length-2)):s=t:s+=parseFloat(i))},this)),0>s&&(s=e+s),s},e._parseXPosition=function(t,i){return e._parsePosition(t,e._parentWidth(i))},e._parseYPosition=function(t,i){return e._parsePosition(t,e._parentHeight(i))},e._postDrawHandling=function(e,i,s,a){0===a?(i.each(function(t,i){null!==e.afterDraw&&void 0!==e.afterDraw&&e.afterDraw(this,t,i)}),s.remove()):(i.each("end",function(t,i){null!==e.afterDraw&&void 0!==e.afterDraw&&e.afterDraw(this,t,i)}),s.each("end",function(){t.select(this).remove()}))},e._removeTooltip=function(t,e,i){i._tooltipGroup&&i._tooltipGroup.remove()},e._rollUp=function(t,e,i){var s=[];return e=null!==e&&void 0!==e?[].concat(e):[],t.forEach(function(t){var a=-1,r={},n=!0;s.forEach(function(i,s){-1===a&&(n=!0,e.forEach(function(e){n=n&&t[e]===i[e]},this),n&&(a=s))},this),-1!==a?r=s[a]:(e.forEach(function(e){r[e]=t[e]},this),s.push(r),a=s.length-1),i.forEach(function(i){-1===e.indexOf(i)&&(void 0===r[i]&&(r[i]=[]),r[i]=r[i].concat(t[i]))},this),s[a]=r},this),s},e._showBarTooltip=function(e,i,s,a){var r,n,o,l,h,u,c=5,d=10,g=750,p=t.select(i),_=p.node().getBBox().x,f=p.node().getBBox().y,x=p.node().getBBox().width,y=p.node().getBBox().height,m=p.attr("opacity"),v=p.attr("fill"),F=a._dropLineOrigin(),k=t.rgb(t.rgb(v).r+.6*(255-t.rgb(v).r),t.rgb(v).g+.6*(255-t.rgb(v).g),t.rgb(v).b+.6*(255-t.rgb(v).b)),w=t.rgb(t.rgb(v).r+.8*(255-t.rgb(v).r),t.rgb(v).g+.8*(255-t.rgb(v).g),t.rgb(v).b+.8*(255-t.rgb(v).b)),C=a.getTooltipText(e),b=0,P=0,B=0,S=function(t,e){var i=p.node().getCTM(),a=s.svg.node().createSVGPoint();return a.x=t||0,a.y=e||0,a.matrixTransform(i)};null!==s._tooltipGroup&&void 0!==s._tooltipGroup&&s._tooltipGroup.remove(),s._tooltipGroup=s.svg.append("g"),a.p||(u=a._isStacked()?1:x/2,a.x._hasCategories()||null===F.y||s._tooltipGroup.append("line").attr("x1",_<a.x._origin?_+u:_+x-u).attr("y1",f<F.y?f+y:f).attr("x2",_<a.x._origin?_+u:_+x-u).attr("y2",f<F.y?f+y:f).style("fill","none").style("stroke",v).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",m).transition().delay(g/2).duration(g/2).ease("linear").attr("y2",f<F.y?F.y-1:F.y+1),u=a._isStacked()?1:y/2,a.y._hasCategories()||null===F.x||s._tooltipGroup.append("line").attr("x1",_<F.x?_+x:_).attr("y1",f<a.y._origin?f+u:f+y-u).attr("x2",_<F.x?_+x:_).attr("y2",f<a.y._origin?f+u:f+y-u).style("fill","none").style("stroke",v).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",m).transition().delay(g/2).duration(g/2).ease("linear").attr("x2",_<F.x?F.x-1:F.x+1)),r=s._tooltipGroup.append("g"),n=r.append("rect").attr("class","dimple-tooltip "+s.customClassList.tooltipBox),r.selectAll(".dimple-dont-select-any").data(C).enter().append("text").attr("class","dimple-tooltip "+s.customClassList.tooltipLabel).text(function(t){return t}).style("font-family",a.tooltipFontFamily).style("font-size",a._getTooltipFontSize()),r.each(function(){P=this.getBBox().width>P?this.getBBox().width:P,B=this.getBBox().width>B?this.getBBox().height:B}),r.selectAll("text").attr("x",0).attr("y",function(){return b+=this.getBBox().height,b-this.getBBox().height/2}),n.attr("x",-c).attr("y",-c).attr("height",Math.floor(b+c)-.5).attr("width",P+2*c).attr("rx",5).attr("ry",5).style("fill",w).style("stroke",k).style("stroke-width",2).style("opacity",.95),S(_+x+c+d+P).x<parseFloat(s.svg.node().getBBox().width)?(o=_+x+c+d,l=f+y/2-(b-(B-c))/2):S(_-(c+d+P)).x>0?(o=_-(c+d+P),l=f+y/2-(b-(B-c))/2):S(0,f+y+b+d+c).y<parseFloat(s.svg.node().getBBox().height)?(o=_+x/2-(2*c+P)/2,o=o>0?o:d,o=o+P<parseFloat(s.svg.node().getBBox().width)?o:parseFloat(s.svg.node().getBBox().width)-P-d,l=f+y+2*c):(o=_+x/2-(2*c+P)/2,o=o>0?o:d,o=o+P<parseFloat(s.svg.node().getBBox().width)?o:parseFloat(s.svg.node().getBBox().width)-P-d,l=f-b-(B-c)),h=S(o,l),r.attr("transform","translate("+h.x+" , "+h.y+")")},e._showPointTooltip=function(i,s,a,r){var n,o,l,h,u=5,c=10,d=750,g=t.select(s),p=parseFloat(g.attr("cx")),_=parseFloat(g.attr("cy")),f=parseFloat(g.attr("r")),x=e._helpers.opacity(i,a,r),y=g.attr("stroke"),m=r._dropLineOrigin(),v=t.rgb(t.rgb(y).r+.6*(255-t.rgb(y).r),t.rgb(y).g+.6*(255-t.rgb(y).g),t.rgb(y).b+.6*(255-t.rgb(y).b)),F=t.rgb(t.rgb(y).r+.8*(255-t.rgb(y).r),t.rgb(y).g+.8*(255-t.rgb(y).g),t.rgb(y).b+.8*(255-t.rgb(y).b)),k=0,w=0,C=0,b=r.getTooltipText(i);null!==a._tooltipGroup&&void 0!==a._tooltipGroup&&a._tooltipGroup.remove(),a._tooltipGroup=a.svg.append("g"),a._tooltipGroup.append("circle").attr("cx",p).attr("cy",_).attr("r",f).attr("opacity",0).style("fill","none").style("stroke",y).style("stroke-width",1).transition().duration(d/2).ease("linear").attr("opacity",1).attr("r",f+r.lineWeight+2).style("stroke-width",2),null!==m.y&&a._tooltipGroup.append("line").attr("x1",p).attr("y1",_<m.y?_+f+r.lineWeight+2:_-f-r.lineWeight-2).attr("x2",p).attr("y2",_<m.y?_+f+r.lineWeight+2:_-f-r.lineWeight-2).style("fill","none").style("stroke",y).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",x).transition().delay(d/2).duration(d/2).ease("linear").attr("y2",_<m.y?m.y-1:m.y+1),null!==m.x&&a._tooltipGroup.append("line").attr("x1",p<m.x?p+f+r.lineWeight+2:p-f-r.lineWeight-2).attr("y1",_).attr("x2",p<m.x?p+f+r.lineWeight+2:p-f-r.lineWeight-2).attr("y2",_).style("fill","none").style("stroke",y).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",x).transition().delay(d/2).duration(d/2).ease("linear").attr("x2",p<m.x?m.x-1:m.x+1),n=a._tooltipGroup.append("g"),o=n.append("rect").attr("class","dimple-tooltip"),n.selectAll(".dont-select-any").data(b).enter().append("text").attr("class","dimple-tooltip").text(function(t){return t}).style("font-family",r.tooltipFontFamily).style("font-size",r._getTooltipFontSize()),n.each(function(){w=this.getBBox().width>w?this.getBBox().width:w,C=this.getBBox().width>C?this.getBBox().height:C}),n.selectAll("text").attr("x",0).attr("y",function(){return k+=this.getBBox().height,k-this.getBBox().height/2}),o.attr("x",-u).attr("y",-u).attr("height",Math.floor(k+u)-.5).attr("width",w+2*u).attr("rx",5).attr("ry",5).style("fill",F).style("stroke",v).style("stroke-width",2).style("opacity",.95),p+f+u+c+w<parseFloat(a.svg.node().getBBox().width)?(l=p+f+u+c,h=_-(k-(C-u))/2):p-f-(u+c+w)>0?(l=p-f-(u+c+w),h=_-(k-(C-u))/2):_+f+k+c+u<parseFloat(a.svg.node().getBBox().height)?(l=p-(2*u+w)/2,l=l>0?l:c,l=l+w<parseFloat(a.svg.node().getBBox().width)?l:parseFloat(a.svg.node().getBBox().width)-w-c,h=_+f+2*u):(l=p-(2*u+w)/2,l=l>0?l:c,l=l+w<parseFloat(a.svg.node().getBBox().width)?l:parseFloat(a.svg.node().getBBox().width)-w-c,h=_-k-(C-u)),n.attr("transform","translate("+l+" , "+h+")")},e.filterData=function(t,e,i){var s=t;return null!==e&&null!==i&&(null!==i&&void 0!==i&&(i=[].concat(i)),s=[],t.forEach(function(t){null===t[e]?s.push(t):i.indexOf([].concat(t[e]).join("/"))>-1&&s.push(t)},this)),s},e.getUniqueValues=function(t,e){var i=[];return null!==e&&void 0!==e&&(e=[].concat(e),t.forEach(function(t){var s="";e.forEach(function(e,i){i>0&&(s+="/"),s+=t[e]},this),-1===i.indexOf(s)&&i.push(s)},this)),i},e.newSvg=function(e,i,s){var a=null;if((null===e||void 0===e)&&(e="body"),a=t.select(e),a.empty())throw"The '"+e+"' selector did not match any elements.  Please prefix with '#' to select by id or '.' to select by class";return a.append("svg").attr("width",i).attr("height",s)},e});

